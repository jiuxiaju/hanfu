{"version":3,"file":"pages/shop/online-detail/index.js","mappings":";;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","sources":["webpack:///./pages/shop/online-detail/index.ts"],"sourcesContent":["var __MOR_API__ = require('@morjs/api').mor;\n\nimport { aPage } from '@ali/mor-core';\naPage({\n    data: {\n        list: [],\n        displayList: [],\n        batchSize: 10,\n        currentDisplayCount: 0,\n        shopInfo: {},\n        dianming: '',\n        menuData: [],\n        rowColsAvatar: [{ size: '100px', type: 'circle' }],\n        rowColsContent: [{ width: '80%' }, { width: '100%' }, { width: '80%' }],\n        rowColsImage: [{ size: '100px', type: 'rect' }],\n        isLoadingContent: true,\n        config: {\n            \"hanfu_style\": {\n                // \"fields\": ['brand', 'sizes', 'delivery_time'],\n                // \"displayValuesOnly\": [],\n                // \"fieldLabels\": { 'brand': \"品牌\", 'sizes': \"尺码\", 'delivery_time': '发货周期' },\n                // \"styles\": {\n                //   \"brand\": {\n                //     \"background-color\": \"#6dd40033\",\n                //     \"color\": \"#53A101\"\n                //   }\n                // }\n                fields: ['brand', 'size', 'delivery_time', 'gender'],\n                displayValuesOnly: [],\n                fieldLabels: { 'brand': \"品牌\", 'size': \"尺码\", 'delivery_time': '发货周期', 'gender': '适宜性别' },\n                styles: {\n                    brand: {\n                        \"background-color\": \"#6dd40033\",\n                        \"color\": \"#53A101\"\n                    }\n                },\n                search: {},\n                imageStyles: {\n                    width: \"70%\" // 默认图像宽度为100%\n                }\n            },\n        },\n        filteredData: {},\n        mergedData: []\n    },\n    onLoad: function (query) {\n        var _this = this;\n        this.stylelist();\n        this.fetchMenuData();\n        var itemId = query.itemId || '';\n        this.setData({\n            itemId: itemId\n        });\n        wx.cloud\n            .callFunction({\n            // 云函数名称\n            name: \"online-detail\",\n            data: {\n                itemId: itemId\n            }\n        })\n            .then(function (res) {\n            console.log(res, 'res');\n            var result = res.result;\n            _this.setData({\n                shopInfo: result.data[0],\n            });\n            console.log(_this.data.shopInfo, 'shopInfo');\n        });\n    },\n    methods: {\n        onShareAppMessage: function () {\n            var promise = new Promise(function (resolve) {\n                setTimeout(function () {\n                    resolve({\n                        title: '九霞裾',\n                    });\n                }, 20);\n            });\n            return {\n                title: '九霞裾',\n                path: '/pages/home',\n                promise: promise,\n            };\n        },\n        onShareTimeline: function () {\n            return {\n                title: '快来看看',\n            };\n        },\n        handleMultipleSelect: function (e) {\n            this.setData({\n                'multipleSelect.value': e.detail.value,\n            });\n        }\n    },\n    //分享给好友\n    onShareAppMessage: function () {\n        var app = getApp(); // 获取全局应用实例\n        var promise = new Promise(function (resolve) {\n            app.generateShareInfo().then(function (shareInfo) {\n                // 在这里处理生成的分享信息\n                resolve(shareInfo);\n            });\n        });\n        return {\n            title: '九霞裾',\n            path: '/pages/home',\n            promise: promise\n        };\n    },\n    //转发到朋友圈\n    onShareTimeline: function () {\n        return {\n            title: '快来看看'\n        };\n    },\n    onScrollViewScroll: function (e) {\n        var scrollTop = e.detail.scrollTop; // 用户当前已滚动的距离\n        var scrollHeight = e.detail.scrollHeight; // scroll-view 内容的总高度\n        var scrollViewHeight = 700; // scroll-view 的固定高度\n        var triggerHeight = 200; // 触发加载数据的提前量（距底部 200px）\n        // 检查是否接近底部，并触发数据加载\n        if (scrollTop + scrollViewHeight >= scrollHeight - triggerHeight) {\n            console.log('接近底部，加载更多数据...');\n            // this.loadMoreData();\n            this.onScrollToLower();\n        }\n    },\n    //监控页面滚动\n    onScrollToLower: function () {\n        // 当滑动到页面底部时触发\n        var _a = this.data, list = _a.list, displayList = _a.displayList, currentDisplayCount = _a.currentDisplayCount, batchSize = _a.batchSize;\n        console.log(currentDisplayCount, 'currentDisplayCount');\n        var nextDisplayCount = currentDisplayCount + batchSize;\n        if (currentDisplayCount < list.length) {\n            // 有更多数据可以加载\n            var moreData = list.slice(currentDisplayCount, nextDisplayCount);\n            this.setData({\n                displayList: displayList.concat(moreData),\n                currentDisplayCount: nextDisplayCount, // 更新已显示的数据数量\n            });\n        }\n    },\n    handleItemClick: function (event) {\n        var item = event.detail;\n        var itemId = event.detail._id;\n        console.log(itemId, 'itemId');\n        // 检查 shouldNavigate 字段\n        if (!item.hasOwnProperty('shouldNavigate') || !item.shouldNavigate) {\n            __MOR_API__.showToast({ title: '该款式不可跳转', icon: 'none' });\n            return;\n        }\n        __MOR_API__.navigateTo({\n            url: \"/pages/shop/style/index?itemId=\" + itemId,\n        });\n    },\n    fetchMenuData: function () {\n        var _this = this;\n        wx.cloud.callFunction({\n            name: 'menuOptions', // 请替换成您的云函数名\n        }).then(function (res) {\n            var result = res.result; // 这里接收到的result应该是一个数组\n            console.log(result, 'rmenuDataesult'); // 查看返回数据\n            _this.setData({\n                menuData: result\n            });\n        });\n    },\n    stylelist: function (filteredData) {\n        var _this = this;\n        if (filteredData === void 0) { filteredData = {}; }\n        var itemId = this.data.itemId;\n        console.log(itemId, filteredData, 'itemId');\n        wx.cloud\n            .callFunction({\n            // 云函数名称\n            name: \"stylelist\",\n            data: {\n                itemId: itemId,\n                filteredData: filteredData\n            }\n        }).then(function (res) {\n            console.log(res, 'res1');\n            var result = res.result;\n            var styleList = result.data;\n            var newProducts = styleList.filter(function (item) { return item.isNew; });\n            _this.setData({\n                config: result.config,\n                currentDisplayCount: 10,\n                list: styleList,\n                newProducts: newProducts,\n                displayList: styleList.slice(0, _this.data.batchSize),\n                isLoadingContent: false,\n            });\n            console.log(newProducts, _this.data.config, 'newProducts');\n        });\n    },\n    handleMenuData: function (event) {\n        var filterData = event.detail;\n        this.setData({\n            filteredData: filterData\n        });\n        var filteredData = this.data.filteredData;\n        console.log('filteredData12', filteredData);\n        this.stylelist(filteredData);\n    },\n    navigateToUrl: function (event) {\n        var style = event.currentTarget.dataset.style;\n        console.log('navigateToUrl:', style); // 调试输出\n        __MOR_API__.navigateTo({\n            url: \"/pages/population-list/detail/index?style=\" + style,\n        });\n    }\n});\n"],"names":[],"sourceRoot":""}