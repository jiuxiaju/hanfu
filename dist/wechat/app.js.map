{"version":3,"file":"app.js","mappings":";;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","sources":["webpack:///./app.ts"],"sourcesContent":["import { __assign } from \"tslib\";\nimport { aApp } from '@ali/mor-core';\naApp({\n    globalData: {\n        placeholderWords: [{\n                query: \"æœç´¢æ¨èè¯...\",\n                updated: false,\n                text: '',\n                currentTab: ''\n            },],\n        queryHistoryArr: [],\n        dataReady: false,\n        dataReadyCallback: null\n    },\n    onLaunch: function () {\n        var _this = this;\n        console.log(\"ğŸš€ ~ file: app.ts:39 ~ onLaunch ~ onLaunch:\");\n        this.initCloud();\n        this.updatePlaceholderWord();\n        this.loadQueryHistory().then(function () {\n            console.log('æˆ‘loadQueryHistoryæ‰§è¡Œå®Œäº†');\n            // è°ƒç”¨ updatePlaceholderWord æ›´æ–°å ä½è¯\n            _this.updatePlaceholderWord();\n        }),\n            // æ¼”ç¤ºå¦‚ä½•è·å– queryHistoryArr\n            console.log('åˆå§‹åŒ–æ—¶çš„ queryHistoryArr:', this.globalData.queryHistoryArr);\n        this.globalData.sysinfo = wx.getSystemInfoSync();\n        var updateManager = wx.getUpdateManager();\n        updateManager.onCheckForUpdate(function (res) {\n            // è¯·æ±‚å®Œæ–°ç‰ˆæœ¬ä¿¡æ¯çš„å›è°ƒ\n            console.log(res.hasUpdate);\n        });\n        updateManager.onUpdateReady(function () {\n            wx.showModal({\n                title: 'æ›´æ–°æç¤º',\n                content: 'æ–°ç‰ˆæœ¬å·²ç»å‡†å¤‡å¥½ï¼Œæ˜¯å¦é‡å¯åº”ç”¨ï¼Ÿ',\n                success: function (res) {\n                    if (res.confirm) {\n                        // æ–°çš„ç‰ˆæœ¬å·²ç»ä¸‹è½½å¥½ï¼Œè°ƒç”¨ applyUpdate åº”ç”¨æ–°ç‰ˆæœ¬å¹¶é‡å¯\n                        updateManager.applyUpdate();\n                    }\n                }\n            });\n        });\n        updateManager.onUpdateFailed(function () {\n            // æ–°çš„ç‰ˆæœ¬ä¸‹è½½å¤±è´¥\n            wx.showModal({\n                title: 'æ›´æ–°æç¤º',\n                content: 'æ–°ç‰ˆæœ¬ä¸‹è½½å¤±è´¥',\n                showCancel: false\n            });\n        });\n    },\n    globalData: {\n        sysinfo: {},\n    },\n    loadQueryHistory: function () {\n        // è·å–æœ¬åœ°å­˜å‚¨çš„å†å²è®°å½•\n        try {\n            var queryHistoryArr = wx.getStorageSync('queryHistory') || [];\n            this.globalData.queryHistoryArr = queryHistoryArr;\n        }\n        catch (e) {\n            console.error(\"Failed to load query history:\", e);\n        }\n    },\n    saveQueryHistory: function (queryHistoryArr) {\n        // ä¿å­˜æœç´¢å†å²è®°å½•åˆ°æœ¬åœ°å­˜å‚¨\n        try {\n            wx.setStorageSync('queryHistory', queryHistoryArr);\n            this.globalData.queryHistoryArr = queryHistoryArr;\n        }\n        catch (e) {\n            console.error(\"Failed to save query history:\", e);\n        }\n    },\n    updatePlaceholderWord: function () {\n        var _this = this;\n        var queryHistoryArr = this.globalData.queryHistoryArr;\n        console.log(queryHistoryArr, 'queryHistoryArr');\n        wx.cloud.callFunction({\n            name: 'getPlaceholderWords',\n            data: {\n                queryHistoryArr: queryHistoryArr\n            },\n            success: function (res) {\n                var result = res.result;\n                if (Array.isArray(result) && result.length > 0) {\n                    _this.globalData.placeholderWords = result.map(function (word) { return (__assign(__assign({}, word), { updated: true })); });\n                    // æ ‡è®°æ•°æ®å·²å‡†å¤‡å¥½ï¼Œå¹¶è°ƒç”¨å›è°ƒå‡½æ•°\n                    _this.globalData.dataReady = true;\n                    if (_this.globalData.dataReadyCallback) {\n                        _this.globalData.dataReadyCallback();\n                    }\n                }\n                // æ‰“å°å®Œæ•´çš„ placeholderWord\n                console.log('æ›´æ–°åçš„ placeholderWord:', _this.globalData.placeholderWords);\n            },\n            fail: function (error) {\n                console.error('Cloud function call failed: ', error);\n            }\n        });\n    },\n    // å®šä¹‰å…¨å±€æ–¹æ³•è·å–è·¯å¾„å’Œå‚æ•°\n    getCurrentPagePathWithArgs: function () {\n        var pages = getCurrentPages(); // è·å–åŠ è½½çš„é¡µé¢\n        var currentPage = pages[pages.length - 1]; // è·å–å½“å‰é¡µé¢çš„å¯¹è±¡\n        var url = \"/\" + currentPage.route; // å½“å‰é¡µé¢url\n        // è·å–é¡µé¢å‚æ•°\n        var options = currentPage.options;\n        var queryParameters = Object.keys(options)\n            .map(function (key) { return key + \"=\" + options[key]; })\n            .join('&');\n        return url + \"?\" + queryParameters;\n    },\n    // å®šä¹‰å…¨å±€æ–¹æ³•ç”Ÿæˆåˆ†äº«ä¿¡æ¯\n    generateShareInfo: function () {\n        var _this = this;\n        return new Promise(function (resolve) {\n            var pathWithArgs = _this.getCurrentPagePathWithArgs(); // è·å–å½“å‰é¡µé¢çš„è·¯å¾„å’Œå‚æ•°\n            resolve({\n                title: 'ä¹éœè£¾',\n                path: pathWithArgs,\n                // imageUrl: '/path/to/share-image.jpg' // åˆ†äº«çš„å›¾ç‰‡è·¯å¾„\n            });\n        });\n    },\n    initCloud: function () {\n        wx.cloud.init({\n            env: 'jiuxiaju-7ghefl5n6fc39431',\n        });\n        console.log(\"ğŸš€ ~ file: app.ts:47 ~ initCloud ~ wx.cloud:\", wx.cloud);\n    },\n    /**\n     * è½¬æ¢å¯Œæ–‡æœ¬text\n     * @param text\n     * @returns\n     */\n    convertRichText: function (text) {\n        if (text && typeof text === 'string') {\n            // å¤„ç†å›¾ç‰‡å®½åº¦\n            return text.replace(/<(img).*?(\\/>|<\\/img>)/g, function (mats) {\n                if (mats.indexOf('style') < 0) {\n                    return mats.replace(/<\\s*img/, '<img style=\"max-width:100%;height:auto;\"');\n                }\n                else {\n                    return mats.replace(/style=(\"|')/, 'style=$1max-width:100%;height:auto;');\n                }\n            });\n        }\n        return text;\n    },\n});\n"],"names":[],"sourceRoot":""}